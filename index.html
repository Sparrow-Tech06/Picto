<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Learn Symbols</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');

  body { 
    background: #fdfdfd; 
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #1a1a1a;
    -webkit-tap-highlight-color: transparent;
  }

  /* Progress & Header */
  .status-text { font-size: 14px; font-weight: 700; color: #999; letter-spacing: 0.5px; }
  .heart-box { font-size: 20px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)); }
  .heart-off { opacity: 0.2; filter: grayscale(1); transform: scale(0.8); transition: 0.4s; }

  .progress-container {
    height: 4px;
    background: #f0f0f0;
    width: 100%;
    position: fixed;
    top: 0; left: 0;
  }
  .progress-fill {
    height: 100%;
    background: #00cf7f;
    transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Card Design */
  .game-wrapper { max-width: 420px; margin: 40px auto; padding: 20px; }
  
  .quiz-card {
    background: #ffffff;
    border-radius: 32px;
    padding: 40px 24px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.04);
    border: 1px solid rgba(0,0,0,0.05);
    transition: all 0.3s ease;
  }

  .symbol-box {
    font-size: 96px;
    margin-bottom: 24px;
    line-height: 1;
    display: block;
  }

  /* Option Buttons */
  .option-btn {
    background: #f8f9fa;
    border: 2px solid transparent;
    border-radius: 18px;
    padding: 16px;
    font-size: 17px;
    font-weight: 600;
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    color: #333;
    width: 100%;
    margin-bottom: 12px;
  }

  .option-btn:active {
    transform: scale(0.96);
    background: #fff;
    border-color: #00cf7f;
  }

  /* Modern Overlay */
  .custom-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(8px);
    z-index: 9999;
    display: flex; align-items: center; justify-content: center;
  }

  .popup-content {
    background: white;
    padding: 40px;
    border-radius: 40px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.1);
    text-align: center;
    max-width: 320px;
    width: 90%;
  }

  /* Animations */
  .shake { animation: shakeAnim 0.4s ease-in-out; }
  @keyframes shakeAnim {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    75% { transform: translateX(8px); }
  }

  .v-enter-active, .v-leave-active { transition: opacity 0.3s ease, transform 0.3s ease; }
  .v-enter-from, .v-leave-to { opacity: 0; transform: translateY(10px); }
</style>
</head>

<body>
<div id="app">

  <div v-if="screen==='game'" class="progress-container">
    <div class="progress-fill" :style="{ width: progressPercent + '%' }"></div>
  </div>

  <section v-if="screen==='home'" class="text-center py-5">
    <div style="font-size: 80px; margin-top: 10vh;">üé®</div>
    <h2 class="fw-800 mt-4">Learn Symbols</h2>
    <p class="text-muted mb-5">Identify the symbols and stay alive!</p>
    <button class="btn btn-dark btn-lg px-5 rounded-pill fw-bold shadow-lg" @click="startGame">
      Start Game
    </button>
  </section>

  <main v-if="screen==='game'" class="game-wrapper">
    <header class="d-flex justify-content-between align-items-center mb-4">
      <div class="status-text text-uppercase">
        Question {{ index + 1 }} <span class="text-light-emphasis mx-1">/</span> {{ total }}
      </div>
      <div class="heart-box">
        <span v-for="h in 3" :key="h" :class="{ 'heart-off': h > lives }">‚ù§Ô∏è</span>
      </div>
    </header>

    <transition mode="out-in">
      <div v-if="loaded" class="quiz-card text-center" :class="{ shake: isWrong }" :key="index">
        <span class="symbol-box">{{ current.symbol }}</span>
        <h5 class="fw-bold mb-4">What's this called?</h5>
        
        <div class="options-list">
          <button v-for="op in current.options" 
                  @click="check(op)" 
                  class="option-btn shadow-sm">
            {{ op }}
          </button>
        </div>

        <div class="mt-4 small text-muted">
          {{ total - (index + 1) }} more to go
        </div>
      </div>
    </transition>
  </main>

  <transition>
    <div class="custom-overlay" v-if="overlay.show">
      <div class="popup-content">
        <div style="font-size: 70px;" class="mb-3">{{ overlay.icon }}</div>
        <h3 class="fw-800 mb-2">{{ overlay.title }}</h3>
        <p class="text-muted mb-4" v-if="overlay.msg">{{ overlay.msg }}</p>
        <button class="btn btn-dark w-100 rounded-pill py-3 fw-bold" @click="handleAction">
          {{ overlay.btn }}
        </button>
      </div>
    </div>
  </transition>

</div>

<script>
const { createApp } = Vue;

createApp({
  data() {
    return {
      screen: 'home',
      cards: [],
      index: 0,
      lives: 3,
      loaded: false,
      isWrong: false,
      overlay: { show: false, icon: '', title: '', msg: '', action: '', btn: '' }
    }
  },
  computed: {
    current() { return this.cards[this.index] || {}; },
    total() { return this.cards.length; },
    progressPercent() { return ((this.index) / this.total) * 100; }
  },
  methods: {
    startGame() {
      this.index = 0;
      this.lives = 3;
      this.screen = 'game';
      this.overlay.show = false;
    },
    check(ans) {
      if (ans === this.current.answer) {
        // Correct Answer Confetti
        confetti({
          particleCount: 80,
          spread: 50,
          origin: { y: 0.7 },
          colors: ['#00cf7f', '#ffffff', '#ffd700']
        });

        if (this.index === this.total - 1) {
          this.showOverlay('üèÜ', 'You Finished!', 'Amazing job! You got them all.', 'home', 'Back to Home');
        } else {
          this.showOverlay('‚ú®', 'Correct!', 'You are doing great!', 'next', 'Continue');
        }
      } else {
        this.lives--;
        this.isWrong = true;
        setTimeout(() => this.isWrong = false, 400);

        if (this.lives === 0) {
          this.showOverlay('üíÄ', 'Game Over', 'Don\'t worry, try again!', 'home', 'Restart');
        }
      }
    },
    showOverlay(icon, title, msg, action, btn) {
      this.overlay = { show: true, icon, title, msg, action, btn };
    },
    handleAction() {
      this.overlay.show = false;
      if (this.overlay.action === 'next') {
        this.index++;
      } else if (this.overlay.action === 'home') {
        this.screen = 'home';
      }
    }
  },
  mounted() {
    fetch('data.json')
      .then(r => r.json())
      .then(d => {
        this.cards = d;
        this.loaded = true;
      })
      .catch(e => console.error("Could not load data.json. Make sure it exists in the same folder."));
  }
}).mount('#app');
</script>
</body>
</html>
